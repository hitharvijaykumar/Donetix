{% extends 'base.html' %}
{% block title %}Donator Dashboard{% endblock %}
{% block content %}
<h2>Your Donations</h2>
<a href="/add-donation"><button>Add New Donation</button></a>

{% for donation in donations %}
    <div class="card">
        <p class="card-title">{{ donation.category }}</p>
        <p class="card-text">{{ donation.description }}</p>
        <p>Quantity: {{ donation.quantity }}</p>
        <p>Location: {{ donation.location }}</p>
        <p>Status: {% if donation.available %}Available{% else %}Requested{% endif %}</p>

        {% for req in donation.request_set.all %}
            <p>Request from: {{ req.ngo.username }}</p>

            {% if not req.accepted %}
                <form action="{% url 'accept_request' req.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit">Accept Request</button>
                </form>
            {% else %}
                <p>Request Accepted</p>
                <a href="{% url 'chat' req.ngo.id %}">
                    <button>Chat with {{ req.ngo.username }}</button>
                </a>
            {% endif %}
        {% endfor %}
    </div>
{% endfor %}
{% endblock %}